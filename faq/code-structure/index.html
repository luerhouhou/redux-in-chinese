<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-faq/code-structure">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-66122997-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-M7SNC3FDW9"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-M7SNC3FDW9",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Redux 中文官网" href="/opensearch.xml"><title data-rh="true">Code Structure | Redux 中文官网</title><meta data-rh="true" property="og:image" content="http://cn.redux.js.org/img/redux-logo-landscape.png"><meta data-rh="true" name="twitter:image" content="http://cn.redux.js.org/img/redux-logo-landscape.png"><meta data-rh="true" property="og:url" content="http://cn.redux.js.org/faq/code-structure"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="twitter:card" content="summary"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Code Structure | Redux 中文官网"><meta data-rh="true" name="description" content="目录"><meta data-rh="true" property="og:description" content="目录"><link data-rh="true" rel="icon" href="/img/favicon/favicon.ico"><link data-rh="true" rel="canonical" href="http://cn.redux.js.org/faq/code-structure"><link data-rh="true" rel="alternate" href="http://cn.redux.js.org/faq/code-structure" hreflang="en"><link data-rh="true" rel="alternate" href="http://cn.redux.js.org/faq/code-structure" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.f2db9367.css">
<link rel="preload" href="/assets/js/runtime~main.1ecc7dbe.js" as="script">
<link rel="preload" href="/assets/js/main.7ecee670.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Redux 中文官网</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/introduction/getting-started">入门</a><a class="navbar__item navbar__link" href="/tutorials/essentials/part-1-overview-concepts">教程</a><a class="navbar__item navbar__link" href="/api/api-reference">API</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/faq">常见问题</a><a class="navbar__item navbar__link" href="/style-guide/style-guide">最佳实践</a><a href="https://www.github.com/nefe/redux-in-chinese" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">源码<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/nefe/redux-in-chinese/issues" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">纠错</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/introduction/getting-started">简介</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/tutorials/index">教程</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/usage/">使用指南</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/understanding/thinking-in-redux/motivation">深入理解 Redux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/faq">常见问题</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/faq">FAQ 目录</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/faq/general">General</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/faq/reducers">Reducers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/faq/organizing-state">Organizing State</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/faq/store-setup">Store Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/faq/actions">Actions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/faq/immutable-data">Immutable Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/faq/code-structure">Code Structure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/faq/performance">Performance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/faq/design-decisions">Design Decisions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/faq/react-redux">React Redux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/faq/miscellaneous">Miscellaneous</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/style-guide/">编码规范</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/api/api-reference">API 文档</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/redux-toolkit/overview">Redux Toolkit</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">常见问题</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Code Structure</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Redux FAQ: 代码结构</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="目录">目录<a class="hash-link" href="#目录" title="Direct link to heading">​</a></h2><ul><li><a href="#what-should-my-file-structure-look-like-how-should-i-group-my-action-creators-and-reducers-in-my-project-where-should-my-selectors-go">我的文件结构应该是什么样的？应该如何在项目中对 action creator 和 reducer 进行分组？selector 应该放在哪里？</a></li><li><a href="#how-should-i-split-my-logic-between-reducers-and-action-creators-where-should-my-business-logic-go">我应该如何在 reducer 和 action creator 之间划分逻辑？“业务逻辑”应该放在哪里？</a></li><li><a href="#why-should-i-use-action-creators">为什么我应该使用 action creator ？</a></li><li><a href="#where-should-websockets-and-other-persistent-connections-live">websockets 和其他持久连接应该在哪里？</a></li><li><a href="#how-can-i-use-the-redux-store-in-non-component-files">如何在非组件文件中使用 Redux store？</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="我的文件结构应该是什么样的应该如何在项目中对-action-creator-和-reducer-进行分组selector应该放在哪里">我的文件结构应该是什么样的？应该如何在项目中对 action creator 和 reducer 进行分组？selector应该放在哪里？<a class="hash-link" href="#我的文件结构应该是什么样的应该如何在项目中对-action-creator-和-reducer-进行分组selector应该放在哪里" title="Direct link to heading">​</a></h2><p>由于 Redux 只是一个数据存储库，对于项目的结构没有直接的意见。但是，有一些大多数 Redux 开发人员倾向于使用的常见模式：</p><ul><li>Rails 样式：“actions”、“constants”、“reducers”、“containers”和“components”的单独文件夹
-“功能文件夹”/“域”样式：每个功能或域的单独文件夹，每个文件类型可能带有子文件夹</li><li>“Ducks/Slices”：类似于领域风格，但明确地将 reducer 和 action 绑定在一起，通常通过在同一个文件中定义它们</li></ul><p>通常建议 selector 与 reducer 一起定义并导出，然后在其他地方重用（例如在 <code>mapStateToProps</code> 函数、异步操作创建器或 sagas 中）以将所有知道状态树实际形状的代码放在 reducer 文件中。</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p><strong>我们特别建议将你的逻辑组织到“功能文件夹”中，将给定功能的所有 Redux 逻辑都放在一个“Ducks/Slices”文件中&quot;</strong>.</p><p>有关示例，请参见本节：</p><details class="detailed-explanation"><summary><h4>Detailed Explanation: Example Folder Structure</h4></summary>示例文件夹结构可能类似于：<ul><li><code>/src</code><ul><li><code>index.tsx</code>: React 组件树的入口点文件</li><li><code>/app</code><ul><li><code>store.ts</code>: store 设置</li><li><code>rootReducer.ts</code>: 根 reducer (可选择的)</li><li><code>App.tsx</code>: 根 React 组件</li></ul></li><li><code>/common</code>: hooks，通用组件，utils，等</li><li><code>/features</code>: 包含所有“功能文件夹”<ul><li><code>/todos</code>: 单个功能文件夹<ul><li><code>todosSlice.ts</code>: Redux reducer 逻辑和相关操作</li><li><code>Todos.tsx</code>: 一个 React 组件</li></ul></li></ul></li></ul></li></ul><p><code>/app</code> 包含依赖于所有其他文件夹的应用程序范围的设置和布局。</p><p><code>/common</code> 包含真正通用和可重用的实用程序和组件。</p><p><code>/features</code> 具有包含与特定功能相关的所有功能的文件夹。在此示例中，<code>todosSlice.ts</code> 是一个 “duck” 风格的文件，其中包含对 RTK 的<code>createSlice()</code> 函数的调用，并导出切片 reducer 和 action creator。</p></details></div></div><p>虽然最终如何在磁盘上布置代码并不重要，但重要的是要记住不应孤立地考虑 action 和 reducer。一个文件夹中定义的 reducer 完全有可能（并且鼓励）响应另一个文件夹中定义的 action。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="更多信息">更多信息<a class="hash-link" href="#更多信息" title="Direct link to heading">​</a></h4><p><strong>文档</strong></p><ul><li><a href="/style-guide/##structure-files-as-feature-folders-with-single-file-logic">Style Guide: 使用单文件逻辑将文件结构作为功能文件夹</a></li><li><a href="/tutorials/essentials/part-2-app-structure">Redux Essentials tutorial: App Structure</a></li><li><a href="/faq/actions#actions-reducer-mappings">FAQ: Actions - “reducer 和 action 之间的 1:1 映射？”</a></li></ul><p><strong>文章</strong></p><ul><li><a href="https://www.smashingmagazine.com/2016/09/how-to-scale-react-applications/" target="_blank" rel="noopener noreferrer">如何扩展 React 应用程序</a> (accompanying talk: <a href="https://vimeo.com/168648012" target="_blank" rel="noopener noreferrer">Scaling React Applications</a>)</li><li><a href="https://medium.com/lexical-labs-engineering/redux-best-practices-64d59775802e" target="_blank" rel="noopener noreferrer">Redux 最佳实践</a></li><li><a href="http://jaysoo.ca/2016/02/28/organizing-redux-application/" target="_blank" rel="noopener noreferrer">结构化 (Redux) 应用程序的规则</a></li><li><a href="https://marmelab.com/blog/2015/12/17/react-directory-structure.html" target="_blank" rel="noopener noreferrer">为 React/Redux 应用程序提供更好的文件结构</a></li><li><a href="http://engineering.kapost.com/2016/01/organizing-large-react-applications/" target="_blank" rel="noopener noreferrer">组织大型 React 应用程序</a></li><li><a href="https://medium.com/@msandin/strategies-for-organizing-code-2c9d690b6f33" target="_blank" rel="noopener noreferrer">组织代码的四种策略</a></li><li><a href="https://randycoulman.com/blog/2016/09/13/encapsulating-the-redux-state-tree/" target="_blank" rel="noopener noreferrer">封装 Redux 状态树</a></li><li><a href="https://randycoulman.com/blog/2016/09/20/redux-reducer-selector-asymmetry/" target="_blank" rel="noopener noreferrer">非对称 Redux Reducer/Selector</a></li><li><a href="https://randycoulman.com/blog/2016/09/27/modular-reducers-and-selectors/" target="_blank" rel="noopener noreferrer">模块化 Reducers and Selectors</a></li><li><a href="https://medium.com/@mmazzarolo/my-journey-toward-a-maintainable-project-structure-for-react-redux-b05dfd999b5" target="_blank" rel="noopener noreferrer">我的 React/Redux 可维护项目结构之旅</a></li><li><a href="https://github.com/markerikson/react-redux-links/blob/master/react-redux-architecture.md#project-file-structure" target="_blank" rel="noopener noreferrer">React/Redux Links: 架构 - 项目文件结构</a></li></ul><p><strong>讨论</strong></p><ul><li><a href="https://github.com/reduxjs/redux/issues/839" target="_blank" rel="noopener noreferrer">#839: 强调在 reducer 旁边定义 selector</a></li><li><a href="https://github.com/reduxjs/redux/issues/943" target="_blank" rel="noopener noreferrer">#943: Reducer querying</a></li><li><a href="https://github.com/mxstbr/react-boilerplate/issues/27" target="_blank" rel="noopener noreferrer">React Boilerplate #27: Application Structure</a></li><li><a href="https://stackoverflow.com/questions/32634320/how-to-structure-redux-components-containers/32921576" target="_blank" rel="noopener noreferrer">Stack Overflow: 如何构建 Redux 组件/容器</a></li><li><a href="https://twitter.com/dan_abramov/status/783428282666614784" target="_blank" rel="noopener noreferrer">Twitter: Redux 没有终极的文件结构</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="我应该如何在-reducer-和-action-creator-之间划分逻辑业务逻辑应该放在哪里">我应该如何在 reducer 和 action creator 之间划分逻辑？“业务逻辑”应该放在哪里？<a class="hash-link" href="#我应该如何在-reducer-和-action-creator-之间划分逻辑业务逻辑应该放在哪里" title="Direct link to heading">​</a></h2><p>对于 reducer 或 action creator 中应该包含哪些逻辑，没有一个明确的答案。一些开发人员更喜欢拥有 “fat” 的 action creator，而 “thin” 的 reducer 只是简单地将 action 中的数据合并到相应的 state 中。其他人试图强调保持action 尽可能小，并尽量减少在 action creator 使用 <code>getState()</code>。（对于这个问题，其他异步方法，如 sagas 和 observables 属于 “action creator” 类别。）</p><p>将更多逻辑放入 reducer 有几个潜在的好处。action 类型可能会更语义化和更有意义（例如 <code>&quot;USER_UPDATED&quot;</code> 而不是 <code>&quot;SET_STATE&quot;</code>）。此外，在 reducer 中有更多的逻辑意味着更多的功能会受到时间旅行调试的影响。</p><p>这条评论很好地总结了二分法：</p><blockquote><p>现在，问题是在 action creator 中放入什么，在 reducer 中放入什么，在 “fat” action 对象和 “thin” action 对象之间进行选择。如果你把所有的逻辑都放在 action creator 中，你最终会得到基本上声明 state 更新的 “fat” action creator 对象。Reducers 变得纯粹、傻瓜式、添加这个、删除那个、更新这些功能。他们将很容易组成。但是你的业务逻辑并不多。
如果你在 reducer 中加入更多逻辑，你最终会得到漂亮、精简的 action 对象，大部分数据逻辑都在一个地方，但是你的 reducer 更难组合，因为你可能需要来自其他分支的信息。您最终会得到大型 reducer 或从该州更高层获取额外参数的 reducer。</p></blockquote><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p><strong>建议将尽可能多的逻辑放入 reducer</strong>. 有时您可能需要一些逻辑来帮助准备 action 中的内容，但 reducer 应该完成大部分工作。</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="更多的信息">更多的信息<a class="hash-link" href="#更多的信息" title="Direct link to heading">​</a></h4><p><strong>文档</strong></p><ul><li><a href="/style-guide/#put-as-much-logic-as-possible-in-reducers">Style Guide: 在 Reducer 中尽可能多地添加逻辑</a></li><li><a href="/style-guide/#model-actions-as-events-not-setters">Style Guide: 将 Actions 作为 “Events”，而不是 “Setters”</a></li></ul><p><strong>文章</strong></p><ul><li><a href="https://medium.com/@jeffbski/where-do-i-put-my-business-logic-in-a-react-redux-application-9253ef91ce1" target="_blank" rel="noopener noreferrer">我应该将业务逻辑放在 React/Redux 应用程序的什么位置？</a></li><li><a href="https://www.smashingmagazine.com/2016/09/how-to-scale-react-applications/" target="_blank" rel="noopener noreferrer">如何扩展 React 应用程序</a></li><li><a href="https://blog.isquaredsoftware.com/2017/05/idiomatic-redux-tao-of-redux-part-2/#thick-and-thin-reducers" target="_blank" rel="noopener noreferrer">Redux 之道，第 2 部分 - 实践与哲学。厚重和轻量的 reducer。</a></li></ul><p><strong>讨论</strong></p><ul><li><a href="https://github.com/reduxjs/redux/issues/384#issuecomment-127393209" target="_blank" rel="noopener noreferrer">在 action creator 中放置过多的逻辑会如何影响调试</a></li><li><a href="https://github.com/reduxjs/redux/issues/384#issuecomment-127393209" target="_blank" rel="noopener noreferrer">#384:reducer 中的内容越多，您可以通过时间旅行重播的内容越多</a></li><li><a href="https://github.com/reduxjs/redux/issues/1165" target="_blank" rel="noopener noreferrer">#1165: 在哪里放置业务逻辑/验证？</a></li><li><a href="https://github.com/reduxjs/redux/issues/1171" target="_blank" rel="noopener noreferrer">#1171: 关于 action-creator、reducer 和 selector 的最佳实践建议</a></li><li><a href="https://stackoverflow.com/questions/35667249/accessing-redux-state-in-an-action-creator/35674575" target="_blank" rel="noopener noreferrer">Stack Overflow: 在 action-creator 中访问 Redux state？</a></li><li><a href="https://github.com/reduxjs/redux/issues/2796#issue-289298280" target="_blank" rel="noopener noreferrer">#2796: 明确“业务逻辑”</a></li><li><a href="https://twitter.com/FwardPhoenix/status/952971237004926977" target="_blank" rel="noopener noreferrer">Twitter: 远离不明确的术语...</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="为什么应该使用-action-creator">为什么应该使用 action creator？<a class="hash-link" href="#为什么应该使用-action-creator" title="Direct link to heading">​</a></h2><p>Redux 不需要 action creator。您可以以任何最适合您的方式自由创建 action，包括简单地将对象文字传递给 <code>dispatch</code>。action creator从 <a href="https://facebook.github.io/react/blog/2014/07/30/flux-actions-and-the-dispatcher.html#actions-and-actioncreators" target="_blank" rel="noopener noreferrer">Flux 架构</a> 中出现并被 Redux 社区采用，因为它们提供了几个好处。</p><p>Action creator 更易于维护。可以在一个地方对 action 进行更新，并在任何地方应用。保证 action 的所有实例具有相同的状态和相同的默认值。</p><p>Action creator 是可测试的。必须手动验证内联 action 的正确性。与任何函数一样，action creator 的测试可以编写一次并自动运行。</p><p>Action creator 更容易记录。Action creator 的参数枚举 action 的依赖关系。action 定义的集中化为文档注释提供了一个方便的地方。内联编写 action 时，这些信息更难捕获和交流。</p><p>Action creator 是一个更强大的抽象。创建 action 通常涉及转换数据或发出 AJAX 请求。Action creator 为这种不同的逻辑提供了统一的接口。这种抽象释放了一个组件来 dispatch 一个动作，而不会因为该 action 的创建细节而变得复杂。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="更多信息-1">更多信息<a class="hash-link" href="#更多信息-1" title="Direct link to heading">​</a></h4><p><strong>文章</strong></p><ul><li><a href="https://blog.isquaredsoftware.com/2016/10/idiomatic-redux-why-use-action-creators/" target="_blank" rel="noopener noreferrer">惯用的 Redux：为什么使用 action creator ？</a></li></ul><p><strong>Discussions</strong></p><ul><li><a href="https://www.reddit.com/r/reactjs/comments/54k8js/redbox_redux_action_creation_made_simple/d8493z1/?context=4" target="_blank" rel="noopener noreferrer">Reddit: Redbox - 使 Redux action 创建变得简单</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="websockets-和其他持久连接应该放在哪里">Websockets 和其他持久连接应该放在哪里？<a class="hash-link" href="#websockets-和其他持久连接应该放在哪里" title="Direct link to heading">​</a></h2><p>Middleware 是 Redux 应用程序中持续连接（如 websockets）的正确位置，原因如下：</p><ul><li>Middleware 存在于应用程序的生命周期中</li><li>与 store 本身一样，你可能只需要整个应用程序中可以使用的给定连接的单个实例</li><li>Middleware 可以看到所有 dispatch 的 action 和自己 dispatch 的 action 。这意味着 middleware 可以采取 dispatch 的 action 并将其转换为通过 websocket 发送的消息，并在通过 websocket 接收到消息时 dispatch 新的 action。</li><li>websocket 连接实例不可序列化，因此<a href="/faq/organizing-state#organizing-state-non-serializable">它不属于 store state 本身</a></li></ul><p>请参阅 <a href="https://gist.github.com/markerikson/3df1cf5abbac57820a20059287b4be58" target="_blank" rel="noopener noreferrer">此示例显示 socket middleware 如何 dispatch 和响应 Redux action</a>.</p><p>有许多用于 websocket 和其他类似连接的现有 middleware - 请参阅下面的链接。</p><p><strong>库</strong></p><ul><li><a href="https://github.com/markerikson/redux-ecosystem-links/blob/master/middleware-sockets-adapters.md" target="_blank" rel="noopener noreferrer">Middleware: Socket and Adapters</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="如何在非组件文件中使用-redux-store">如何在非组件文件中使用 Redux store？<a class="hash-link" href="#如何在非组件文件中使用-redux-store" title="Direct link to heading">​</a></h2><p>每个应用程序应该只有一个 Redux store。这使得它在应用程序架构方面实际上是一个单例。与 React 一起使用时，通过在根 <code>&lt;App&gt;</code> 组件周围渲染 <code>&lt;Provider store={store}&gt;</code>，将 store 在运行时注入到组件中，因此只有应用程序设置逻辑需要直接导入 store。</p><p>但是，有时代码库的其他部分也需要与 store 交互。</p><p><strong>您应该避免将 store 直接导入其他代码库文件</strong>. 虽然它在某些情况下可能会起作用，但这通常会导致循环导入依赖错误。</p><p>一些可能的解决方案：</p><ul><li>将依赖于 store 的逻辑编写为 thunk，然后从组件中 dispatch 该 thunk。</li><li>将组件中对 “dispatch” 的引用作为相关函数的参数传递。</li><li>将逻辑编写为 middleware，并在设置时将它们添加到 store 中。</li><li>在创建应用程序时将 store 实例注入相关文件。</li></ul><p>一个常见的用例是在 Axios 拦截器内部读取 API 授权信息，例如来自 Redux state 的令牌。拦截器文件需要引用 <code>store.getState()</code>，还需要导入API层文件，导致循环导入。</p><p>您可以从拦截器文件中暴露一个 <code>injectStore</code> 函数：</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockTitle_Ktv7">common/api.js</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> store</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">injectStore</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">_store</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  store </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> _store</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">axiosInstance</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">interceptors</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">request</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">use</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token parameter">config</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    config</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">headers</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">authorization</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> store</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">getState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">auth</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">token</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#F92672">return</span><span class="token plain"> config</span><span class="token punctuation" style="color:#F8F8F2">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然后，在你的入口点文件中，将 store 注入 API 设置文件：</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#f8f8f2;--prism-background-color:#272822"><div class="codeBlockTitle_Ktv7">index.js</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports">store</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;./app/store&quot;</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#F8F8F2">{</span><span class="token imports">injectStore</span><span class="token imports punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;./common/api&quot;</span><span class="token punctuation" style="color:#F8F8F2">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token function" style="color:#E6D874">injectStore</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">store</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这样，应用程序设置是唯一必须导入 store 的代码，文件依赖图避免了循环依赖。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/faq/immutable-data"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Immutable Data</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/faq/performance"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Performance</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#目录" class="table-of-contents__link toc-highlight">目录</a></li><li><a href="#我的文件结构应该是什么样的应该如何在项目中对-action-creator-和-reducer-进行分组selector应该放在哪里" class="table-of-contents__link toc-highlight">我的文件结构应该是什么样的？应该如何在项目中对 action creator 和 reducer 进行分组？selector应该放在哪里？</a></li><li><a href="#我应该如何在-reducer-和-action-creator-之间划分逻辑业务逻辑应该放在哪里" class="table-of-contents__link toc-highlight">我应该如何在 reducer 和 action creator 之间划分逻辑？“业务逻辑”应该放在哪里？</a></li><li><a href="#为什么应该使用-action-creator" class="table-of-contents__link toc-highlight">为什么应该使用 action creator？</a></li><li><a href="#websockets-和其他持久连接应该放在哪里" class="table-of-contents__link toc-highlight">Websockets 和其他持久连接应该放在哪里？</a></li><li><a href="#如何在非组件文件中使用-redux-store" class="table-of-contents__link toc-highlight">如何在非组件文件中使用 Redux store？</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/introduction/getting-started">入门</a></li><li class="footer__item"><a class="footer__link-item" href="/tutorials/essentials/part-1-overview-concepts">教程</a></li><li class="footer__item"><a class="footer__link-item" href="/faq">常见问题</a></li><li class="footer__item"><a class="footer__link-item" href="/api/api-reference">API 文档</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/0ZcbPKXt5bZ6au5t" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reactiflux Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="http://stackoverflow.com/questions/tagged/redux" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/introduction/getting-started#help-and-discussion">Feedback</a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/nefe/redux-in-chinese" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item">
                <a href="https://www.netlify.com">
                  <img src="https://www.netlify.com/img/global/badges/netlify-color-accent.svg" alt="Deploys by Netlify">
                </a>
              </li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://redux.js.org/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/img/redux.svg" alt="Redux Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">Copyright © 2015–2022 Dan Abramov and Cam Song.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.1ecc7dbe.js"></script>
<script src="/assets/js/main.7ecee670.js"></script>
</body>
</html>